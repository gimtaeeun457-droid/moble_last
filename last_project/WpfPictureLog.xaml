<UserControl x:Class="last_project.WpfPictureLog"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="500"
             Background="#FF2D2D30" Foreground="White">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Picture Log" FontSize="18" FontWeight="Bold" Margin="0,0,0,10" />

        <Border Grid.Row="1" Background="#FF3E3E42" CornerRadius="5" Padding="10" Margin="0,0,0,10">
            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <TextBlock Text="Date :" VerticalAlignment="Center" Margin="0,0,10,0" Foreground="#FFCCCCCC"/>
                    <DatePicker x:Name="DtPicker" Width="120" VerticalContentAlignment="Center"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Time :" VerticalAlignment="Center" Margin="0,0,10,0" Foreground="#FFCCCCCC"/>
                    <ComboBox x:Name="CmbStartHour" Width="60" />
                    <TextBlock Text="~" VerticalAlignment="Center" Margin="5,0"/>
                    <ComboBox x:Name="CmbEndHour" Width="60" />

                    <Button Content="검색" Click="BtnSearch_Click" 
                            Width="60" Margin="10,0,5,0" Background="#FF3B82F6" Foreground="White" BorderThickness="0"/>
                    <Button Content="전체" Click="BtnReset_Click" 
                            Width="60" Background="#FF555555" Foreground="White" BorderThickness="0"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <ListBox Grid.Row="2" 
                 x:Name="LogListBox"
                 ItemsSource="{Binding FilteredLogs}" 
                 BorderThickness="0"
                 Background="#FF1E1E1E" 
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                 ScrollViewer.VerticalScrollBarVisibility="Auto"
                 HorizontalContentAlignment="Stretch"
                 VerticalContentAlignment="Stretch">

            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Columns="3" />
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>

            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Border BorderBrush="#FF4F4F52" 
                            BorderThickness="1" 
                            CornerRadius="5" 
                            Padding="5" Margin="2">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <Image Grid.Row="0"
                                   Source="{Binding ImagePath}"
                                   Stretch="Uniform"
                                   Margin="0,0,0,5"
                                   Cursor="Hand" 
                                   MouseLeftButtonDown="SmallImage_MouseLeftButtonDown"
                                   MinHeight="100" />

                            <StackPanel Grid.Row="1" HorizontalAlignment="Center">
                                <TextBlock Text="{Binding Timestamp, StringFormat='yyyy-MM-dd HH:mm:ss'}" 
                                           Foreground="#FF9A9A9A" 
                                           FontSize="10" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="{Binding Description}" 
                                           Foreground="White" 
                                           FontSize="11" 
                                           HorizontalAlignment="Center"
                                           TextTrimming="CharacterEllipsis" />
                            </StackPanel>
                        </Grid>
                    </Border>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

    </Grid>
</UserControl>